\newlength{\len}% SECTION / SUBSECTION で書名等の引数の長さ計算用

\newcommand{\SECTION}[6]{%
  \def\mySecTitleORIG{#1}% 書名・詩集名（原）   { {Liederkreis }
  \def\mySecTitleTRAN{#2}% 書名・詩集名（訳）   { リーダークライス }
  \def\mySecYOMI{#3}%%%%%% %よみ              { りーだーくらいす }
  \def\mySecREFERENCE{#4}% 整理番号            { Op.24 }
  \def\mySecMiscORIG{#5}%% 監修者等(訳)        { ハインリッヒ・ハイネ }
  \def\mySecMiscTRAN{#6}%% 監修者等(原)、年情報 { Heinrich Heine }
  %
  \newpage%
  %
  % (注意) 以下は SUBSECTION と同じデザインだが、
  % 将来それぞれのデザイン変更等に対応するため再定義
  %
  \def\glueA{~ ~ \hfill}%
  %
  % 以下のように制御すると原題あるいは邦訳のどちらかの長さが規定以上の
  % 時複雑な計算を要するので、X することは \parbox なので改行などの調
  % 整はlatex に任せる
  %
  % 原文・訳文側の関連項目のどちらか一方指定時 \par\hfill で改行・右寄せ
  \def\glueB{} \settowidth{\len}{\mySecMiscORIG\mySecMiscTRAN} \ifdim \len > 0pt \def\glueB{\par\hfill} \fi%
  %
  \phantomsection%
  \section*{%
    \begin{tblr}[t]{ | X[r] @{ ~ ~ ~ ~ ~ ~ } X[r] | }%
      \hline\hline[2pt]%
      {\mySecTitleORIG\small\glueA \mySecREFERENCE \glueB\mySecMiscORIG} & %
      {\mySecTitleTRAN\small\glueA                 \glueB\mySecMiscTRAN} \\%
      \hline[2pt]\hline%
    \end{tblr}%
  }%
  \label{mySecindex:section:\mySecREFERENCE}%
  \index{\mySecTitleORIG(\mySecYOMI)@\mySecTitleORIG(\mySecTitleTRAN)}%
  \index{\mySecYOMI(\mySecTitleORIG)@\mySecTitleTRAN(\mySecTitleORIG)}%
  \addcontentsline{toc}{section}%
  {%
    \makebox[.465\textwidth][l]{{\small \mySecREFERENCE} ~ \mySecTitleORIG \dotfill}%
    ~ ~ %
    \makebox[.465\textwidth][l]{                          ~ \mySecTitleTRAN \dotfill}%
  }%
  \fancyhead[L]{\small\mySecTitleORIG}%
  \fancyhead[R]{\small\mySecTitleTRAN}%
  \bigskip%
}

\newcommand{\SUBSECTION}[8]{%
  \def\mySubSecTitleORIG{#1}%%%% 書名・詩名（原）
  \def\mySubSecTitleTRAN{#2}%%%% 書名・詩名（訳）
  \def\mySubSecYOMI{#3}%%%%%%%%% よみ
  \def\mySubSecREFERENCE{#4}%%%% 整理番号
  \def\mySubSecLyricistORIG{#5}% 作詞家情報（原）
  \def\mySubSecLyricistTRAN{#6}% 作詞家情報（訳）
  \def\mySubSecComposerORIG{#7}% 作曲家情報（原）
  \def\mySubSecComposerTRAN{#8}% 作曲家情報（訳）
  %
  \bigskip\bigskip%
  \needspace{12\baselineskip}%
  %
  % (注意) 以下は SECTION と同じデザインだが、
  % 将来それぞれのデザイン変更等に対応するため再定義
  %
  \def\glueA{~ ~ \hfill}
  % 以下のように制御すると原題あるいは邦訳のどちらかの長さが規定以上の
  % 時複雑な計算を要するので、X することは \parbox なので改行などの調
  % 整はlatex に任せる
  %
  % 原文・訳文側の関連項目のどちらか一方指定時 \par\hfill で改行・右寄せ
  \def\glueB{} \settowidth{\len}{\mySubSecLyricistORIG\mySubSecLyricistTRAN} \ifdim \len > 0pt \def\glueB{\par\hfill} \fi%
  \def\glueC{} \settowidth{\len}{\mySubSecComposerORIG\mySubSecComposerTRAN} \ifdim \len > 0pt \def\glueC{\par\hfill} \fi%
  %
  \phantomsection%
  \par% ヘッダーのルーラーとの干渉解消のため
  \subsection*{%
    \begin{tblr}[t]{ | X[r] @{ ~ ~ ~ ~ ~ ~ } X[r] | }%
      % コメント化した部分を利用すると微妙な空白が入り右詰めの
      % 行末が不揃いになる
      \hline[dotted]\hline%
      {\mySubSecTitleORIG\small\glueA \mbox{ \mySubSecREFERENCE}\glueB\mySubSecLyricistORIG\glueC\mySubSecComposerORIG} & %
      {\mySubSecTitleTRAN\small\glueA \mbox{                   }\glueB\mySubSecLyricistTRAN\glueC\mySubSecComposerTRAN} \\%
      \hline\hline[dotted]%
    \end{tblr}%
    }%
    \bigskip% 作品コンテンツとタイトル部分を際立てる為
    %
    \index{\mySubSecTitleORIG(\mySubSecYOMI)@\mySubSecTitleORIG(\mySubSecTitleTRAN)}%
    \index{\mySubSecYOMI(\mySubSecTitleORIG)@\mySubSecTitleTRAN(\mySubSecTitleORIG)}%
    \addcontentsline{toc}{subsection}%
    {%
      \makebox[.465\textwidth][l]{{\small \mySubSecREFERENCE} ~ \mySubSecTitleORIG \dotfill\hspace{1em}}%
      ~ %
      \makebox[.465\textwidth][l]{                            ~ \mySubSecTitleTRAN \dotfill\hspace{1em}}%
    }%
}
% 次ページに跨る時のメッセージ制御
\DefTblrTemplate{contfoot-text}{normal}{\footnotesize 次ページに続く}%%%{Continued on next page}
\SetTblrTemplate{contfoot-text}{normal}
\DefTblrTemplate{conthead-text}{normal}{}%%%{(Continued)}
\SetTblrTemplate{conthead-text}{normal}

% 次ページに table: という表示を消す
\DefTblrTemplate{caption-tag}{normal}{}
\SetTblrTemplate{caption-tag}{normal}
\DefTblrTemplate{caption-sep}{normal}{}
\SetTblrTemplate{caption-sep}{normal}

\newenvironment{myTBLR}[1][]%
{%
  \needspace{4\baselineskip}%
  \bigskip%
  \begin{longtblr}%
    [ %
    caption   = {}   , %
    label     = none , %
    #1                 %
    ] %
    { %
      colspec = { X | @{ ~ ~ ~ ~ ~ } X }, % 等配分
    } %
    %
  }{\end{longtblr}%
  \bigskip%次の作品との距離はここで基本調整
  \bigskip%
}
